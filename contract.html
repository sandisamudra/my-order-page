<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contract Agreement</title>

  <!-- Google Fonts: Nunito -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito&display=swap" rel="stylesheet" />

  <!-- Style -->
  <style>
    body {
      font-family: 'Nunito', sans-serif;
      background: white;
      color: #000;
      margin: 0;
      padding: 40px;
      line-height: 1.6;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    p {
      text-align: justify;
    }

     .img-box {
      width: 100%;
      max-width: 400px;
      margin: 15px 0;
      border: 2px solid #ccc;
      padding: 5px;
      text-align: center;
    }
    .img-box img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 0 auto;
    }
    

    @media (max-width: 932px) {
      
      body { 
        padding: 10px;
        font-size: 12px; 
    }

    .label-termin {
    display: flex;
    justify-content: flex-start;
    font-size: 13px !important;
    font-weight: normal;
    margin: 1px 0;
    gap: 1% !important;
    }
    
    .label-row {
    display: flex;
    justify-content: flex-start;
    font-size: 13px !important;
    font-weight: normal;
    margin: 1px 0;
    gap: 1% !important;
    }
}

     .img-box {
      width: 100%;
      max-width: 400px;
      margin: 15px 0;
      border: 2px solid #ccc;
      padding: 5px;
      text-align: center;
    }
    .img-box img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 0 auto;
    }

    

    @media print {
      body {
        margin: 0;
        padding: 40px;
      }

      .no-print {
        display: none !important;
      }
       #signature-pad, .button-group {
   display: none !important;
    }
       .container {
      background: white;
    box-shadow: none !important;
    border: none !important;
    border-radius: 0 !important;
    outline: none !important;
    margin: auto;
    padding: auto;
    }
      
    }

    h1, h3, h4 {
      margin: 0;
      padding: 0;
    }

    h2 {
      margin-bottom: 10px !important;
    }

    /* Tambahan opsional */
    .center {
      text-align: center;
    }

    .section {
      margin-bottom: 30px;
    }
     .label-row {
    display: flex;
    justify-content: flex-start;
    font-size: 16px;
    font-weight: normal;
    margin: 1px 0;
    gap: 1%;
    }
    .label-row span:first-child {
    width: 150px;  /* Atur agar semua label panjangnya sama */
    text-align: left;
    }
     .label-termin {
    display: flex;
    justify-content: flex-start;
    font-size: 16px;
    font-weight: normal;
    margin: 1px 0;
    gap: 1%;
    }
    .label-termin span:first-child {
    width: 150px;  /* Atur agar semua label panjangnya sama */
    text-align: left;
    }
    .label-paragraf1 {
    display: flex;
    justify-content: flex-start;
    font-size: 13px !important;
    font-weight: normal;
    margin: 2px 0;
    gap: 1%;
    }
    .label-paragraf1 span:first-child {
    width: 100px;  /* Atur agar semua label panjangnya sama */
    text-align: left;
    }
    .label-paragraf2 {
    display: flex;
    justify-content: flex-start;
    font-size: 13px !important;
    font-weight: normal;
    margin: 2px 0;
    gap: 1%;
    }
    .label-paragraf2 span:first-child {
    width: 80px;  /* Atur agar semua label panjangnya sama */
    text-align: left;
    }
    #signature-container {
    display: flex;
    flex-direction: column;
    align-items: flex-end; /* Semua konten signature ke kanan */
    justify-content: space-between;
  }
    #signature-pad {
    width: 300px;
    height: 150px;
    border: 1px solid #000;
    margin-bottom: 10px;
  }

  .button-group button {
    margin: 5px;
  }

  #saved-signature {
    flex: 1;
  }
#saved-signature img {
    display: block; 
    max-width: 100px; 
    margin-top: 20px;
}
    
  </style>
</head>
<body>

  <div class="container">
  <!-- Mulai Konten Di Sini -->
  <div class="section center">
    <h3>CONTRACT AGREEMENT</h3>
    <h3>FILM PRODUCTION EQUIPMENT RENT</h3>
    <h3>WITH WORKING TITLE</h3>
    <h2 style="font-style: italic;">“<span class="project-name">[Project Name]</span>”</h2>
  </div>
  

  <p>
    Agreement with these terms and conditions constitute an agreement between parties which production in this thing represented by <strong id="production-house">[Production House]</strong> (next called <strong>Tenant Party</strong>) with party <strong>PT. WARNA GLOBAL SURYA</strong> as rental of film production equipment (next called <strong>Rental Party</strong>) for a Film production with working title "<strong class="project-name">[Project Name]</strong>" Film.
  </p>

  <p>
    This agreement renting equipments for Film on <strong id="shoot-date">[Date of Shoot]</strong> with Quotation Number <strong id="quote-number">[Quotation Number]</strong> and have obtained approval from Tenant Party with production cost <strong id="grand-total">[Grand Total]</strong> “<em id="grand-total-text">[Grand Total Text]</em>“ <strong id="tax-term">Tax Term</strong> for <strong class="total-days">[Shooting Days]</strong> shooting days, and if the use of those equipments exceeds shooting day, additional fees will be charged to Tenant Party with Rp5.000.000,-/day.
  </p>

  <p id="termin-payment">
    Production cost are divided into <strong style="font-weight: normal;"><span id="total-termin">[Total Termin]</span></strong> termin, which include : 
  </p>
    
  <p id="full-payment">
    Production cost will be payment in full
    <br>
    (Payment due date on <strong style="font-weight: normal;"><span id="full-payment-date">[Full Payment Date]</span></strong>)
  </p>


  <div class="label-termin" id="termin-row-1" style="margin-bottom: 1px;">
  <span>Termin 1 (<strong style="font-weight: normal;"><span id="termin-1">[Termin 1]</span></strong>)</span>
  <span>: <span><strong><span id="total-1">[Total 1]</span></strong> (Payment due date on <strong style="font-weight: normal;"><span id="termin-date-1">[Termin Date 1]</span></strong>)</span></span>
</div> 

<div class="label-termin" id="termin-row-2" style="margin-bottom: 1px;">
  <span>Termin 2 (<strong style="font-weight: normal;"><span id="termin-2">[Termin 2]</span></strong>)</span>
  <span>: <span><strong><span id="total-2">[Total 2]</span></strong> (Payment due date on <strong style="font-weight: normal;"><span id="termin-date-2">[Termin Date 2]</span></strong>)</span></span>
</div> 

<div class="label-termin" id="termin-row-3" style="display: none; margin-bottom: 1px;">
  <span>Termin 3 (<strong style="font-weight: normal;"><span id="termin-3">[Termin 3]</span></strong>)</span>
  <span>: <span><strong><span id="total-3">[Total 3]</span></strong> (Payment due date on <strong style="font-weight: normal;"><span id="termin-date-3">[Termin Date 3]</span></strong>)</span></span>
</div>


  <p>
  Payment above transfer to : 
  </p>

  <div class="label-row">
  <span>Bank Name</span>
  <span>: <span id="bank-name"></span></span>
  </div> 

  <div class="label-row">
  <span>Account Name</span>
  <span>: <span id="account-name"></span></span>
  </div> 

  <div class="label-row">
  <span>Account Number</span>
  <span>: <span id="account-number"></span></span>
  </div> 

  <div class="label-row">
  <span>NPWP</span>
  <span>: <span id="np-wp"></span></span>
  </div> 
    
  <p>
  Both parties agreed that everything which related tax costs government that arose from transaction rent of this equipment becomes both parties responsibility that appropriate with provision and legal regulations which happen in the Republic of Indonesia.
  </p>
  <p>
  For payment purposes tax, Tenant Party and Rental Party agrees and willing to give Company NPWP and other identity that are needed.
  </p>
  <p>
  Period time of this equipment rent is for <strong style="font-weight: normal;"><span class="total-days">[Shooting Days]</span></strong> shooting days based on published working schedule from the Tenant Party along with Tenant Party’s agreement signature process.
  </p>
  <p>
  If there is an addition shooting days by Tenant Party after reaching agreed a duration for Tenant Party is willing to pay extra charge per day.
  </p>
  <p>
  Tenant Party provides transportation for the transport of equipment which rented with use a vehicle that meets safety requirements and roadworthy.
  </p>
  <p>
  Tenant Party understand that for lighting equipment and grips are not listed cost insurance in this rental agreement, so if there is a problem occurs which caused by usage of unreasonable, including :
  </p>

  <div class="label-paragraf1">
  <span>1.</span>
  <span>| <span>Used for dangerous scenes such as explosion scenes, artificial rain scenes, racing scenes, scenes fire, equipment submerged in water, crash action and rigging, then for Tenant Party must inform the Rental Party in advance and sign a letter special agreement for this.</span></span>
  </div> 
  <div class="label-paragraf2">
  <span>2.</span>
  <span>| <span>All risks of damage arising from the use of equipment for dangerous scenes production as in the example above and without confirmation to the Rental Party in advance, then be the full responsibility of Tenant Party.</span></span>
  </div> 
 
  <p>
  For the scenes production outside the city or stay overnight, Tenant Party must provide all these services for equipment crew guard corresponding with Tenant Party policy, which include lodging accomodation, transportation, etc.
  </p>  
  <p>
  Tenant Party required to confirm crew call and shooting location one day previously to Rental Party or equipment crew guard in a field according with the schedule.
  </p>
  <p>
  These Contract Agreement is formed from the agreed quotation from Tenant Party and Rental Party. By signing every page Tenant Party is deemed to have read and agreed with everything which written therein.
  </p>

  <div style="display: flex; justify-content: space-between; margin-top: 5px;">
  <p style="text-align: left;">Tenant Party</p>
  <p style="text-align: right;">Rental Party</p>
  </div>
    
  <div id="signature-container">
  <canvas id="signature-pad" class="signature-pad"></canvas>
  <div class="button-group">
    <button onclick="clearSignature()">Clear</button>
    <button onclick="saveSignature()">Save</button>
    <input type="file" id="upload-signature" accept="image/*" style="display: none;" onchange="handleUpload(event)">
    <button onclick="document.getElementById('upload-signature').click()">Upload Signature</button>
    <button onclick="window.print()">Print</button>
  </div>
  <div id="saved-signature"></div>
  </div>
  <div style="display: flex; justify-content: space-between; margin-top: 1px !important;">
  <div style="text-align: center;">
    <div style="border-top: 1px solid #000; width: 200px; margin-bottom: 1px !important;"></div>
    <p style="text-align: left; margin-top: 2px !important;" id="client-name">Tenant Party</p>
  </div>
  <div style="text-align: center;">
    <div style="border-top: 1px solid #000; width: 200px; margin-bottom: 1px !important;"></div>
    <p style="text-align: right; margin-top: 1px !important;" id="rental-name">Rental Party</p>
  </div>

  <p style="font-size: 30px; text-align: left;">Rental Party Documents</p>

 <!-- KTP -->
  <div class="img-box">
    <h3>KTP</h3>
    <img src="assets/KTP Sandi.webp" alt="Foto KTP">
  </div>

    <div class="img-box">
    <h3>KTP</h3>
    <img src="assets/KTP Pak Tino.webp" alt="Foto KTP">
  </div>

  <!-- NPWP -->
  <div class="img-box">
    <h3>NPWP</h3>
    <img src="assets/NPWP Perusahaan.webp" alt="Foto NPWP">
  </div>

  <script>

    const urlParams       = new URLSearchParams(window.location.search);      
    const projectName     = urlParams.get("projectName") || "";
    const productionHouse = urlParams.get("productionHouse") || "";
    const date            = urlParams.get("date") || "";
    const quoteNumber     = urlParams.get("quoteNumber") || "";
    const grandTotal      = urlParams.get("grandTotal") || "0";
    const totalDays       = urlParams.get("totalDays") || "";
    const totalTerm       = urlParams.get("totalTerm") || "";
    const total1          = urlParams.get("total1") || "";
    const total2          = urlParams.get("total2") || "";
    const fullPaymentDate = urlParams.get("fullPaymentDate") || "";
    const terminDate1     = urlParams.get("terminDate1") || "";
    const terminDate2     = urlParams.get("terminDate2") || "";
    const bankName        = urlParams.get("bankName") || "";
    const accountName     = urlParams.get("accountName") || "";
    const accountNumber   = urlParams.get("accountNumber") || "";
    const npwp            = urlParams.get("npwp") || "";
    const clientName      = urlParams.get("clientName") || "";
    const rentalName      = urlParams.get("rentalName") || "";
    const termin1         = urlParams.get("termin1") || "";
    const termin2         = urlParams.get("termin2") || "";
    const total3          = urlParams.get("total3") || "";
    const termin3         = urlParams.get("termin3") || "";
    const terminDate3     = urlParams.get("terminDate3") || "";
    const fileName        = urlParams.get("fileName") || "";
    const taxTerm         = urlParams.get("taxTerm") || "";
    const ktpPhoto        = urlParams.get("ktp-photo") || "";
    const compNPWP        = urlParams.get("comp-npwp") || "";

    if (fileName) document.title = fileName;    
 
    function numberToWords(num) {
      const angka = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine"];
      const belasan = ["Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", 
                       "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
      const puluhan = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];
      const ribuan = ["", "Thousand", "Million", "Billion"];

      if (isNaN(num)) return "";

      let str = "";
      let i = 0;
      while (num > 0) {
        let s = "";
        let n = num % 1000;
        if (n >= 100) {
          s += angka[Math.floor(n / 100)] + " Hundred ";
          n %= 100;
        }
        if (n >= 10 && n <= 19) {
          s += belasan[n - 10] + " ";
        } else {
          if (n >= 20) {
            s += puluhan[Math.floor(n / 10)] + " ";
          }
          if (n % 10 > 0) {
            s += angka[n % 10] + " ";
          }
        }
        if (s) {
          str = s + ribuan[i] + " " + str;
        }
        num = Math.floor(num / 1000);
        i++;
      }
      return str.trim();
    };

    function toTitleCase(str) {
  return str.replace(/\w\S*/g, function(txt) {
    return txt.charAt(0).toUpperCase() + txt.substring(1).toLowerCase();
  });
}
    function formatRupiah(angka) {
  return 'Rp' + parseInt(angka).toLocaleString('id-ID');
}
   
const textAmountRaw = numberToWords(parseInt(grandTotal));
const textAmount = toTitleCase(textAmountRaw);

    document.querySelectorAll(".project-name").forEach(el => el.innerText = projectName);
    document.getElementById("production-house").innerText                 = productionHouse;
    document.getElementById("shoot-date").innerText                       = date;
    document.getElementById("quote-number").innerText                     = quoteNumber;
    document.getElementById("grand-total").innerText                      = formatRupiah(grandTotal);
    document.querySelectorAll(".total-days").forEach(el => el.innerText   = totalDays);
    document.getElementById("grand-total-text").innerText                 = `${textAmount}`;
    document.getElementById("total-termin").innerText                     = totalTerm;
    document.getElementById("tax-term").innerText                         = taxTerm;
    document.getElementById("total-1").innerText                          = formatRupiah(total1);
    document.getElementById("total-2").innerText                          = formatRupiah(total2);
    document.getElementById("full-payment-date").innerText                = fullPaymentDate;
    document.getElementById("termin-date-1").innerText                    = terminDate1;
    document.getElementById("termin-date-2").innerText                    = terminDate2;
    document.getElementById("bank-name").innerText                        = bankName;
    document.getElementById("account-name").innerText                     = accountName;
    document.getElementById("account-number").innerText                   = accountNumber;
    document.getElementById("np-wp").innerText                            = npwp;
    document.getElementById("client-name").innerText                      = clientName;
    document.getElementById("rental-name").innerText                      = rentalName;
    document.getElementById("termin-1").innerText                         = termin1 + "%";
    document.getElementById("termin-2").innerText                         = termin2 + "%";



    // Fungsi untuk render file
    function renderFile(containerId, fileUrl, label) {
      const container = document.getElementById(containerId);

      if (!fileUrl) {
        container.innerText = `Belum ada file ${label}`;
        return;
      }

      // Cek tipe file berdasarkan ekstensi
      if (fileUrl.match(/\.(jpg|jpeg|png|gif)$/i)) {
        container.innerHTML = `<img src="${fileUrl}" alt="${label}">`;
      } else if (fileUrl.match(/\.pdf$/i)) {
        container.innerHTML = `<embed src="${fileUrl}" type="application/pdf" class="pdf-box">`;
      } else {
        container.innerText = `Format file ${label} tidak didukung`;
      }
    }

    // Render masing-masing file
    renderFile("ktp-photo", ktpPhoto, "KTP");
    renderFile("comp-npwp", compNPWP, "NPWP");
    
// Handle termin dinamis
if (totalTerm === "Full Payment") {
  // Full Payment
  document.getElementById("termin-payment").style.display = "none";
  document.getElementById("termin-row-1").style.display = "none";
  document.getElementById("termin-row-2").style.display = "none";
  document.getElementById("termin-row-3").style.display = "none";

} else if (totalTerm === "2") {
  // Dua termin
  document.getElementById("total-termin").innerText = "2";
  document.getElementById("full-payment").style.display = "none";
  document.getElementById("termin-row-1").style.display = "flex";
  document.getElementById("termin-row-2").style.display = "flex";
  document.getElementById("termin-row-3").style.display = "none";

} else if (totalTerm === "3") {
  // Tiga termin
  document.getElementById("total-termin").innerText = "3";
  document.getElementById("full-payment").style.display = "none";
  document.getElementById("termin-row-1").style.display = "flex";
  document.getElementById("termin-row-2").style.display = "flex";
  document.getElementById("termin-row-3").style.display = "flex";

  // Isi nilai termin 3
  document.getElementById("total-3").innerText      = formatRupiah(total3);
  document.getElementById("termin-3").innerText     = termin3 + "%";
  document.getElementById("termin-date-3").innerText= terminDate3;
}

    

  const canvas = document.getElementById("signature-pad");
  const ctx = canvas.getContext("2d");
  let drawing = false;

  function resizeCanvas() {
    const ratio = window.devicePixelRatio || 1;
    canvas.width = canvas.offsetWidth * ratio;
    canvas.height = canvas.offsetHeight * ratio;
    ctx.scale(ratio, ratio);
    ctx.lineWidth = 2;
    ctx.lineJoin = "round";
    ctx.lineCap = "round";
    ctx.strokeStyle = "#000";
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  window.addEventListener("resize", resizeCanvas);
  resizeCanvas();

  function getXY(e) {
    const rect = canvas.getBoundingClientRect();
    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
    return {
      x: clientX - rect.left,
      y: clientY - rect.top
    };
  }

  function startDraw(e) {
    drawing = true;
    const { x, y } = getXY(e);
    ctx.beginPath();
    ctx.moveTo(x, y);
    e.preventDefault();
  }

  function draw(e) {
    if (!drawing) return;
    const { x, y } = getXY(e);
    ctx.lineTo(x, y);
    ctx.stroke();
    e.preventDefault();
  }

  function endDraw() {
    drawing = false;
  }

  canvas.addEventListener("mousedown", startDraw);
  canvas.addEventListener("mousemove", draw);
  canvas.addEventListener("mouseup", endDraw);
  canvas.addEventListener("mouseleave", endDraw);

  canvas.addEventListener("touchstart", startDraw);
  canvas.addEventListener("touchmove", draw);
  canvas.addEventListener("touchend", endDraw);

  function clearSignature() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    document.getElementById("saved-signature").innerHTML = "";
  }

  function saveSignature() {
    const dataURL = canvas.toDataURL("image/png");
    const img = document.createElement("img");
    img.src = dataURL;
    img.style.maxWidth = "150px";
    img.style.marginTop = "0px";

    document.getElementById('saved-signature').innerHTML = "";
    document.getElementById("saved-signature").appendChild(img);
    // Misal ada variabel isSigned = true kalau sudah tanda tangan
  }
    function handleUpload(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
      const img = document.createElement("img");
      img.src = e.target.result;
      img.style.maxWidth = "160px";
      img.style.marginTop = "0px";

      document.getElementById('saved-signature').innerHTML = "";
      document.getElementById("saved-signature").appendChild(img);
    };
    reader.readAsDataURL(file);
  }
  </script>

</body>
</html>
