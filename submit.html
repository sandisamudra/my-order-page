<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sending Order...</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .loading-container {
            text-align: center;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="loading-container">
        <div class="spinner"></div>
        <p>Sending Order...</p>
    </div>

    <script>
        // Ambil data dari URL Glide Apps
        const urlParams = new URLSearchParams(window.location.search);
        const customerName = urlParams.get('customerName');
        const phoneNumber = urlParams.get('phoneNumber');
        const apikey = urlParams.get('apikey');

        // Ambil semua order sebagai string dan pisahkan dengan "|"
        const orderIds = urlParams.get('orderId') ? urlParams.get('orderId').split('|') : [];
        const dates = urlParams.get('date') ? urlParams.get('date').split('|') : [];
        const items = urlParams.get('item') ? urlParams.get('item').split('|') : [];
        const quantities = urlParams.get('quantity') ? urlParams.get('quantity').split('|') : [];
        const froms = urlParams.get('from') ? urlParams.get('from').split('|') : [];
        const tos = urlParams.get('to') ? urlParams.get('to').split('|') : [];

        // Cek apakah semua parameter penting sudah ada
        if (!customerName || !phoneNumber || !apikey || orderIds.length === 0) {
            alert("Missing parameters. Please check your URL.");
        } else {
            // Buat pesan otomatis
            let message = `Customer Name: ${customerName}%0A%0A`;

            // Loop untuk setiap order
            for (let i = 0; i < orderIds.length; i++) {
                message += `Order ${i + 1}:%0A`;
                message += `Order ID: ${orderIds[i] || 'N/A'}%0A`;
                message += `Date: ${dates[i] || 'N/A'}%0A`;
                message += `Item: ${items[i] || 'N/A'}%0A`;
                message += `Quantity: ${quantities[i] || 'N/A'}%0A`;
                message += `From: ${froms[i] || 'N/A'}%0A`;
                message += `To: ${tos[i] || 'N/A'}%0A`;
                message += `%0A`; // Tambahkan baris kosong antara setiap order
            }

            // Kirim ke CallMeBot
            const whatsappUrl = `https://api.callmebot.com/whatsapp.php?phone=${phoneNumber}&text=${message}&apikey=${apikey}`;
            window.location.href = whatsappUrl;
        }
    </script>


</body>
</html>
